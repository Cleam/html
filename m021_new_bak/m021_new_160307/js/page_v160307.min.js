Array.prototype.contains=function(a){return RegExp(a).test(this)},$(function(){function t(){$(".J-has-channel").each(function(a,b){var c=$(b);c.attr("href",c.attr("href")+"?qid="+tt_news_qid)}),readUrl=r.get("all_read_url"),readUrl||(readUrl=""),G("toutiao"),d||(d="",F()),k.each(function(){var a=$(this),b=a.data("type");"meinv"!==b&&"nuanwen"!==b&&newsTypeArr.push(b)});var a=y();a?u(a):v(),i.children(".home").on("click",function(a){a.preventDefault(),Q(200)}),$(window).on("scroll",function(){var a=g.offset().top,b=R(),c=$("#J_footer").offset().top,d=S();B(b),b+m>=a?o&&(o=!1,i.css("zIndex",9),i.stop().animate({opacity:1,top:"0px"},200,"linear")):o||(o=!0,i.stop().animate({opacity:0,top:"-"+m+"px"},100,"linear",function(){i.css("zIndex",-1)})),b+d>=c&&!o&&(clearTimeout(p),p=setTimeout(function(){H()},200))}),$(window).trigger("scroll"),k.on("click",function(){var a=$(this),b=a.parent().index();if(a.hasClass("active"))return!1;e=a.data("type"),s=$.cookie("idx_"+e,Number),k.removeClass("active"),a.addClass("active"),ttNewsNavSwiper.slideTo(b-2,200,!1);var c=C();c?$("body").scrollTop(c):$("body").scrollTop(n+4);var d=A();d?h.html(d):G()}),h.on("click","a",function(a){var b=$(this),c=b.attr("href");c=c.substring(c.indexOf("/mobile/")+8,c.indexOf(".html")),D(c,b.data("type"),b.data("subtype"))})}function u(a){f.attr("data-type",a.prov_py),f.html(a.prov_name)}function v(){$.ajax({type:"POST",url:"http://123.59.74.13/position/get",dataType:"jsonp",jsonp:"jsonpcallback",timeout:5e3}).done(function(a){try{var b=a.position,c=w(b.provname),d=null;c?(d={prov_id:b.pro_id,prov_py:c,prov_name:b.provname},u(d),x(d)):ttNewsNavSwiper.removeSlide(3)}catch(e){console.error(e),ttNewsNavSwiper.removeSlide(3)}}).error(function(a,b){console.error(b),ttNewsNavSwiper.removeSlide(3)})}function w(a){switch(a){case"\u4e0a\u6d77":return"shanghai";case"\u5317\u4eac":return"beijing";case"\u6cb3\u5357":return"henan";case"\u5e7f\u4e1c":return"guangdong";default:return null}}function x(a){r.isSupported()&&r.set("location",a,{exp:43200})}function y(){return r.isSupported()?r.get("location"):!1}function z(){r.isSupported()&&r.set("ttn_"+e,h.html(),{exp:1200})}function A(){return r.isSupported()?r.get("ttn_"+e):!1}function B(a){r.isSupported()&&r.set("ttn_pos_"+e,a,{exp:1200})}function C(){return r.isSupported()?r.get("ttn_pos_"+e):!1}function D(a,b,c){if(!E(a)&&newsTypeArr.contains(b)){var d=r.get("read_url_all");if(d){for(d=d.split(",");d.length>=5;)d.shift();d.push(a),readUrl=d.join(",")}else readUrl=a;r.set("read_url_all",readUrl,{exp:2880});var e=r.get("read_url_"+b);if(e){for(e=e.split(",");e.length>=3;)e.shift();e.push(a),e=e.join(",")}else e=a;if(r.set("read_url_"+b,e,{exp:2880}),c){var f=r.get("read_url_"+c);if(f){for(f=f.split(",");f.length>=3;)f.shift();f.push(a),f=f.join(",")}else f=a;r.set("read_url_"+c,f,{exp:2880})}}}function E(a){var b=r.get("read_url_all");return b&&-1!==b.indexOf(a)?!0:!1}function F(){$.ajax({type:"POST",url:"http://toutiao.eastday.com/getwapdata/getuid",dataType:"jsonp",data:{softtype:"news",softname:"eastday_wapnews"},jsonp:"jsonpcallback",success:function(a){try{d=a.uid,$.cookie("user_id",d,{expires:1825,path:"/"})}catch(b){console.error(b)}}})}function G(){$.cookie("pgnum_"+e,1,{expires:.334,path:"/"}),$.ajax({url:a,data:{type:e,endkey:"",domain:"021",recgid:d,picnewsnum:1,qid:tt_news_qid,readhistory:readUrl,idx:0,pgnum:1},dataType:"jsonp",jsonp:"jsonpcallback",timeout:8e3,beforeSend:function(){h.html(""),q.show()},success:function(a){I(a)},complete:function(){q.hide()}})}function H(){readUrl=r.get("read_url_"+e),pgNum=$.cookie("pgnum_"+e,Number),$.cookie("pgnum_"+e,++pgNum,{expires:.334,path:"/"}),s=$.cookie("idx_"+e,Number),s||(s=0),$.ajax({url:b,data:{type:e,startkey:c,newsnum:20,isnew:1,domain:"021",readhistory:readUrl,idx:s,recgid:d,pgnum:pgNum,qid:tt_news_qid},dataType:"jsonp",jsonp:"jsonpcallback",timeout:8e3,beforeSend:function(){l.show()},success:function(a){I(a)},error:function(a,b){console.error(b)},complete:function(){l.hide()}})}function I(a){var b=a&&a.data;if(!b||!b.length)return l.hide(),!1;c=J(b);var d=b.length;s||(s=0);for(var f=0;d>f;f++){var g=b[f],i=g.url,j=g.date,k=g.topic,m=g.source,n=g.miniimg,o=g.recommendtype?g.recommendtype:"-1",p=g.hotnews,q=g.type,r=g.subtype,t=n.length,u=Number(g.hotnews),v=Number(g.isvideo),w=Number(g.isrecom),x=Number(g.isnxw),y="";u?(y='<i class="hot">\u70ed\u95e8</i>',v&&(y+='<i class="video">\u89c6\u9891</i>')):w?y='<i class="rec">\u63a8\u8350</i>':v?y='<i class="video">\u89c6\u9891</i>':x&&(y='<i class="nuanwen">\u6696\u6587</i>'),t>=3?h.append('<li class="tt-news-item tt-news-item-s2"><a data-type="'+q+'" data-subtype="'+r+'" href="'+i+"?qid="+tt_news_qid+"&idx="+(s+f+1)+"&recommendtype="+o+"&ishot="+p+'"><div class="news-wrap"><h3>'+k+'</h3><div class="img-wrap clearfix"><img class="lazy fl" src="'+n[0].src+'" alt="'+n[0].alt+'"><img class="lazy fl" src="'+n[1].src+'" alt="'+n[1].alt+'"><img class="lazy fl" src="'+n[2].src+'" alt="'+n[2].alt+'"></div><p class="clearfix"><em class="fl">'+(y?y:L(j))+'</em><em class="fr">'+m+"</em></p></div></a></li>"):h.append('<li class="tt-news-item tt-news-item-s1"><a data-type="'+q+'" data-subtype="'+r+'" href="'+i+"?qid="+tt_news_qid+"&idx="+(s+f+1)+"&recommendtype="+o+"&ishot="+p+'"><div class="news-wrap clearfix"><div class="txt-wrap fl"><h3>'+k+'</h3> <p><em class="fl">'+(y?y:L(j))+'</em><em class="fr">'+m+'</em></p></div><div class="img-wrap fr"><img class="lazy" src="'+n[0].src+'" alt="'+n[0].alt+'"></div></div></a></li> ')}$.cookie("idx_"+e,s+d,{expires:.334,path:"/"}),z()}function J(a){try{for(var b=a.length-1;b>=0&&!$.trim(a[b].rowkey);)b--;return a[b].rowkey}catch(c){return console.error(c),""}}function L(a){var b=M(a);if(!b)return!1;var c=(new Date).getTime(),d=Number(c-b),e=864e5,f=36e5,g=6e4;if(d>=e){var h=d/e;return h>2?N(d):h>1?"\u524d\u5929":"\u6628\u5929"}return d>=f?Math.floor(d/f)+"\u5c0f\u65f6\u524d":d>=g?Math.floor(d/g)+"\u5206\u949f\u524d":"\u6700\u65b0"}function M(a){try{return Date.parse(a.replace(/-/g,"/"))}catch(b){return console.error(b),!1}}function N(a,b){return P(O(a),b)}function O(a){return new Date(a)}function P(a,b){var d=(a.getFullYear().toString(),(a.getMonth()+1).toString()),e=a.getDate().toString(),f=a.getHours().toString(),g=a.getMinutes().toString();d=d.length>1?d:"0"+d,e=e.length>1?e:"0"+e,f=f.length>1?f:"0"+f,g=g.length>1?g:"0"+g;var h=d+"-"+e+" "+f+":"+g;return b&&(h=h.replace(/-/g,b)),h}function Q(a){function g(){return!!f&&clearTimeout(f),f=null,$("body").scrollTop()<=0||0>=d?void $("body").scrollTop(0):(d--,b-=e,$("body").scrollTop(b),void(f=setTimeout(function(){g()},c)))}if(!a)return void $(window).scrollTop(0);var b=$("body").scrollTop(),c=13.333,d=Math.ceil(a/c),e=Math.ceil(b/d),f=null;g()}function R(){return document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body?document.body.scrollTop:void 0}function S(){return document.body.clientHeight&&document.documentElement.clientHeight?document.body.clientHeight<document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight:document.body.clientHeight>document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight}FastClick.attach(document.body),function(){var a=$("#J_search_input"),b=$("#J_search_clear");a.on("keyup",function(){""!==$.trim(a.val())?b.show():b.hide()}),b.on("click",function(c){a.val(""),b.hide(),c.preventDefault()})}(),function(){var a=$("#J_hot_site_more");a.on("click",function(a){var b=$(this);"0"==b.data("state")?(b.parent().addClass("expand"),b.data("state","1"),b.find("img").attr("src","img/i_shou.png"),b.find("span").text("\u6536\u8d77")):(b.parent().removeClass("expand"),b.data("state","0"),b.find("img").attr("src","img/i_more.png"),b.find("span").text("\u66f4\u591a")),a.preventDefault()})}(),function(){var a=new Swiper("#J_tabs_container",{speed:300,autoHeight:!0,onSlideChangeStart:function(){var b=$("#J_tabs_container").find(".swiper-slide").eq(a.activeIndex),c=b.parent();c.height(b.height()),$(".cs-tabs").children(".active").removeClass("active"),$(".cs-tabs").children().eq(a.activeIndex).addClass("active")}});$(".cs-tabs a").on("click",function(b){b.preventDefault();var c=$(this);$(".cs-tabs").children(".active").removeClass("active"),c.addClass("active"),a.slideTo(c.index())}),$(".J-more").on("click",function(a){a.preventDefault();var b=this,c=$(this);c.parent().parent().parent().css("height","auto"),c.hasClass("active")?(c.parent().next().hide(),c.removeClass("active")):(c.parent().next().show(),c.addClass("active")),$(".J-more").each(function(a,c){var d=$(c);d.hasClass("active")&&c!==b&&(d.parent().next().hide(),d.removeClass("active"))})})}();var a="http://toutiao.eastday.com/toutiao_h5/RefreshJP",b="http://toutiao.eastday.com/toutiao_h5/NextJP",c="",d=$.cookie("user_id"),e="toutiao",f=$("#J_location"),g=$("#J_tt_news"),h=$("#J_ttnews_list"),i=g.children(".tt-news-nav"),j=$("#J_ttnews_nav_list"),k=j.find(".ttnews-tabs"),l=$("#J_loading"),m=i.outerHeight(),n=g.offset().top-m,o=!0,p=null,q=$("#J_bg_loading"),r=new WebStorageCache,s=$.cookie("idx_"+e,Number);pgNum=1,newsTypeArr=[],readUrl="",ttNewsNavSwiper=new Swiper("#J_ttnews_nav_container",{freeMode:!0,speed:500,slidesPerView:5.5}),t()});